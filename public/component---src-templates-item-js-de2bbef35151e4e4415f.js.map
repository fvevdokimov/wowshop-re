{"version":3,"sources":["webpack:///./node_modules/gatsby-plugin-modal-routing/ModalRoutingLink.js","webpack:///./src/templates/item.js","webpack:///./node_modules/gatsby-plugin-modal-routing/index.js"],"names":["_interopRequireDefault","require","exports","__esModule","_extends2","_objectWithoutPropertiesLoose2","_react","_gatsby","_ModalRoutingContext","_default","_ref","to","asModal","state","rest","createElement","Consumer","_ref2","modal","closeTo","Link","noScroll","SizeTable","sizes","useState","isOpen","setIsOpen","toggle","useCallback","rows","armlength","Handlength","ziplength","seamlength","footlength","Overallslength","forEach","size","Object","entries","key","value","className","color","onClick","style","marginLeft","map","SizePicker","selectedSize","setSize","id","ModalStyleHook","useLayoutEffect","window","document","documentElement","dataset","isItemOpen","ArticleTemplate","item","data","strapiItem","sizetable","addToCart","name","images","description","price","usageicons","icon","src","publicURL","height","query","ModalRoutingContext","_ModalRoutingLink"],"mappings":"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","file":"component---src-templates-item-js-de2bbef35151e4e4415f.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutPropertiesLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _gatsby = require(\"gatsby\");\n\nvar _ModalRoutingContext = _interopRequireDefault(require(\"./ModalRoutingContext\"));\n\nvar ModalRoutingLink = function ModalRoutingLink(_ref) {\n  var to = _ref.to,\n      asModal = _ref.asModal,\n      state = _ref.state,\n      rest = (0, _objectWithoutPropertiesLoose2[\"default\"])(_ref, [\"to\", \"asModal\", \"state\"]);\n  return _react[\"default\"].createElement(_ModalRoutingContext[\"default\"].Consumer, null, function (_ref2) {\n    var modal = _ref2.modal,\n        closeTo = _ref2.closeTo;\n    return _react[\"default\"].createElement(_gatsby.Link, (0, _extends2[\"default\"])({\n      to: to,\n      state: (0, _extends2[\"default\"])({}, state, {\n        modal: asModal,\n        noScroll: to === closeTo\n      })\n    }, rest));\n  });\n};\n\nvar _default = ModalRoutingLink;\nexports[\"default\"] = _default;","import React, {useCallback, useLayoutEffect, useState} from 'react'\nimport { Link, graphql } from 'gatsby'\nimport {Carousel} from \"../components/carousel\";\nimport Img from \"gatsby-image\";\nimport './item.css';\nimport {PrimaryButton} from \"../components/primary-button\";\nimport {Back, Close, CloseWithLabel, CloseWithLabelLink} from \"../components/icons\";\nimport { ModalRoutingContext } from 'gatsby-plugin-modal-routing'\n\nconst SizeTable = ({sizes}) => {\n    const [isOpen, setIsOpen] = useState(false);\n    const toggle = useCallback(() => setIsOpen(!isOpen), [setIsOpen, isOpen])\n    const rows = {\n        armlength: false,\n        Handlength: false,\n        ziplength: false,\n        seamlength: false,\n        footlength: false,\n        Overallslength: false,\n    }\n    sizes.forEach(size => {\n        Object.entries(rows).forEach(([key, value]) => {\n            rows[key] = value || !!size[key];\n        })\n    })\n    return <>\n            <div className={`itemSizeTable__layout${isOpen ? \" open\" : \"\"}`}>\n                <h3 className=\"itemSizeTable__header\">Таблица размеров\n                    <Close color=\"#F2F2F2\" onClick={toggle} style={{marginLeft: 'auto'}}/></h3>\n                <div className=\"itemSizeTable__columns\">\n                    <div className=\"itemSizeTable__labels\">\n                        <span>Размер</span>\n                        {rows.armlength && <span>Длина рукава от ворота</span>}\n                        {rows.Handlength && <span>Длина рукава от плеча</span>}\n                        {rows.ziplength && <span>Длина куртки по замку (от ворота)</span>}\n                        {rows.seamlength && <span>Шаговый шов</span>}\n                        {rows.footlength && <span>Длина стельки</span>}\n                        {rows.Overallslength && <span>Длина комбинезона от ворота</span>}\n                    </div>\n                    {sizes.map(size => <div className=\"itemSizeTable__column\">\n                        <div>{size.size || '-'}</div>\n                        {rows.armlength && <div>{size.armlength || '-'}</div>}\n                        {rows.Handlength && <div>{size.Handlength || '-'}</div>}\n                        {rows.ziplength && <div>{size.ziplength || '-'}</div>}\n                        {rows.seamlength && <div>{size.seamlength || '-'}</div>}\n                        {rows.footlength && <div>{size.footlength || '-'}</div>}\n                        {rows.Overallslength && <div>{size.Overallslength || '-'}</div>}\n                    </div>)}\n                </div>\n            </div>\n            <a className=\"itemSizeTable\" onClick={toggle}>Таблица размеров</a>\n        </>\n}\n\nconst SizePicker = ({sizes, selectedSize, setSize}) => <>\n    <span className=\"itemSelectSize\">Выберите размер</span>\n    <div className=\"itemModalSizes\">\n        {sizes.map(({id, size}) =>\n            <div\n                className={`itemModalSize${selectedSize === id ? ' sizeSelected' : ''}`}\n                onClick={() => setSize(id)}\n            >{size}</div>)}\n    </div>\n    <SizeTable sizes={sizes}/>\n</>\n\nconst ModalStyleHook = () => {\n    useLayoutEffect(() => {\n        if(window) {\n            window.document.documentElement.dataset.isItemOpen = 'true';\n\n            return () => {\n                window.document.documentElement.dataset.isItemOpen = 'false';\n            }\n        }\n    }, [])\n    return null\n}\n\n// TODO: Proper closing\nconst ArticleTemplate = ({ data }) => {\n    const item = data.strapiItem;\n\n    const [selectedSize, setSize] = useState(item.sizetable[0] ? item.sizetable[0].id : -1);\n\n    const addToCart = useCallback(() => {\n        window && window.addToCart && window.addToCart(item.id, selectedSize);\n    }, [item.id, selectedSize]);\n\n    return <ModalRoutingContext.Consumer>\n        {({ modal, closeTo }) => ( <>\n        <h2 className=\"itemModalHeader\">\n            <Link to=\"boys\" className=\"itemPageBack\"><Back color=\"#87338B\"/> Вернуться к покупкам</Link>\n            {item.name}\n            <CloseWithLabelLink to={closeTo} className=\"itemModalClose\" color=\"#87338B99\"/>\n        </h2>\n        <div className=\"itemModalLayout\">\n            <Carousel images={item.images}/>\n            <div className=\"itemModalData\">\n                <SizePicker sizes={item.sizetable} selectedSize={selectedSize} setSize={setSize}/>\n                <PrimaryButton onClick={addToCart}>Добавить в корзину<div className=\"cartIcon\"/></PrimaryButton>\n                <p className=\"itemModalDescription\">{item.description}</p>\n            </div>\n        </div>\n        <div className=\"itemModalRight\">\n            <p className=\"itemModalPrice\">{item.price}.–</p>\n            {item.usageicons.map(({icon}) => <img src={icon.publicURL} height={56}/>)}\n        </div>\n        <ModalStyleHook/>\n        </>)}\n    </ModalRoutingContext.Consumer>\n}\n\nexport default ArticleTemplate\n\nexport const query = graphql`\n    query ArticleTemplate($id: String!) {\n        strapiItem(id: {eq: $id}) {\n            id\n            name\n            price\n            description\n            images {\n                localFile {\n                   publicURL\n                   childImageSharp {\n                       fluid(maxWidth: 400, maxHeight: 400) {\n                           ...GatsbyImageSharpFluid\n                       }\n                   }\n                }\n            }\n            usageicons {\n                usage\n                icon {\n                   publicURL\n                }\n            }\n            sizetable {\n                id\n                size\n                armlength\n                ziplength\n                seamlength\n                Overallslength\n            }\n        }\n    }\n`\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\n\nvar _ModalRoutingContext = _interopRequireDefault(require(\"./ModalRoutingContext\"));\n\nexports.ModalRoutingContext = _ModalRoutingContext[\"default\"];\n\nvar _ModalRoutingLink = _interopRequireDefault(require(\"./ModalRoutingLink\"));\n\nexports.Link = _ModalRoutingLink[\"default\"];"],"sourceRoot":""}